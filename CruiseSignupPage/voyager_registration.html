<!DOCTYPE html>
<html>
<head>
  <title>Voyager Management</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      background-color: #001a1f;
      color: white;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #d2e5e8;
    }
    form {
      background-color: #034357;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: none;
      font-size: 14px;
    }
    input, select {
      background-color: #287091;
      color: white;
    }
    button {
      background-color: #00e5ff;
      color: black;
      font-weight: bold;
      margin-top: 15px;
      cursor: pointer;
    }
    button:hover {
      background-color: #00bcd4;
    }
    table {
      width: 100%;
      margin-top: 30px;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px;
      border: 1px solid #333;
      text-align: center;
    }
    th {
      background-color: #00e5ff;
      color: black;
    }
    tr:nth-child(even) {
      background-color: #1e1e1e;
    }
    .action-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .edit-btn {
      background-color: #4caf50;
      color: white;
    }
    .delete-btn {
      background-color: #f44336;
      color: white;
    }
  </style>
</head>
<body>

  <h1>Voyager Registration</h1>
  <form id="voyagerForm">
    <input type="hidden" id="docId">

    <label>Full Name</label>
    <input type="text" id="fullName" required>

    <label>Email</label>
    <input type="email" id="email" required>

    <label>Phone Number</label>
    <input type="text" id="phoneNumber" required>

    <label>Date of Birth</label>
    <input type="date" id="dob" required>

    <label>Cabin Type</label>
    <input type="text" id="cabinType" required>

    <label>Voyage Date</label>
    <input type="date" id="voyageDate" required>

    <button type="submit">Save Voyager</button>
  </form>

  <h1>Registered Voyagers</h1>
  <table>
    <thead>
      <tr>
        <th>Full Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>DOB</th>
        <th>Cabin Type</th>
        <th>Voyage Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="voyagerTable"></tbody>
  </table>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD0cA756dZeVEbR4Vqovsh5p74niMxNT3w",
      authDomain: "cruise-ship-management-s-98138.firebaseapp.com",
      projectId: "cruise-ship-management-s-98138",
      storageBucket: "cruise-ship-management-s-98138.appspot.com",
      messagingSenderId: "401246402444",
      appId: "1:401246402444:web:dd8a21a7e144e90d3788a9"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const voyagerForm = document.getElementById("voyagerForm");
    const voyagerTable = document.getElementById("voyagerTable");

    // Load Voyagers
    function loadVoyagers() {
      db.collection("voyagerRegistration").orderBy("timestamp", "desc").onSnapshot(snapshot => {
        voyagerTable.innerHTML = "";
        snapshot.forEach(doc => {
          const voyager = doc.data();
          voyagerTable.innerHTML += `
            <tr>
              <td>${voyager.fullName || ""}</td>
              <td>${voyager.email || ""}</td>
              <td>${voyager.phoneNumber || ""}</td>
              <td>${voyager.dob || ""}</td>
              <td>${voyager.cabinType || ""}</td>
              <td>${voyager.voyageDate || ""}</td>
              <td>
                <button class="action-btn edit-btn" onclick="editVoyager('${doc.id}', '${voyager.fullName}', '${voyager.email}', '${voyager.phoneNumber}', '${voyager.dob}', '${voyager.cabinType}', '${voyager.voyageDate}')">Edit</button>
                <button class="action-btn delete-btn" onclick="deleteVoyager('${doc.id}')">Delete</button>
              </td>
            </tr>
          `;
        });
      });
    }

    loadVoyagers();

    // Save or Update Voyager
    voyagerForm.addEventListener("submit", function(e) {
      e.preventDefault();

      const docId = document.getElementById("docId").value;
      const data = {
        fullName: document.getElementById("fullName").value.trim(),
        email: document.getElementById("email").value.trim(),
        phoneNumber: document.getElementById("phoneNumber").value.trim(),
        dob: document.getElementById("dob").value,
        cabinType: document.getElementById("cabinType").value.trim(),
        voyageDate: document.getElementById("voyageDate").value,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      };

      if (docId) {
        db.collection("voyagerRegistration").doc(docId).update(data).then(() => {
          voyagerForm.reset();
          document.getElementById("docId").value = "";
        });
      } else {
        db.collection("voyagerRegistration").add(data).then(() => {
          voyagerForm.reset();
        });
      }
    });

    // Edit Voyager
    window.editVoyager = function(id, fullName, email, phone, dob, cabin, voyageDate) {
      document.getElementById("docId").value = id;
      document.getElementById("fullName").value = fullName;
      document.getElementById("email").value = email;
      document.getElementById("phoneNumber").value = phone;
      document.getElementById("dob").value = dob;
      document.getElementById("cabinType").value = cabin;
      document.getElementById("voyageDate").value = voyageDate;
    };

    // Delete Voyager
    window.deleteVoyager = function(id) {
      if (confirm("Are you sure you want to delete this voyager?")) {
        db.collection("voyagerRegistration").doc(id).delete();
      }
    };
  </script>

</body>
</html>
